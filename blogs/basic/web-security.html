<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Web 开发的安全之旅 | FeliksLv的博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.png">
    <meta name="description" content="记录学习过程，分享生活琐碎。">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.9d8bef43.css" as="style"><link rel="preload" href="/assets/js/app.919d6661.js" as="script"><link rel="preload" href="/assets/js/7.5aa8e1b9.js" as="script"><link rel="preload" href="/assets/js/2.46317bd9.js" as="script"><link rel="preload" href="/assets/js/1.57079a2a.js" as="script"><link rel="preload" href="/assets/js/31.f98198e9.js" as="script"><link rel="prefetch" href="/assets/js/10.7fc491ea.js"><link rel="prefetch" href="/assets/js/11.d111491f.js"><link rel="prefetch" href="/assets/js/14.840e41be.js"><link rel="prefetch" href="/assets/js/15.b3cdf2b1.js"><link rel="prefetch" href="/assets/js/16.fc8d0ab6.js"><link rel="prefetch" href="/assets/js/17.72bfffc9.js"><link rel="prefetch" href="/assets/js/18.514e76b3.js"><link rel="prefetch" href="/assets/js/19.3fd8c814.js"><link rel="prefetch" href="/assets/js/20.2e41d20d.js"><link rel="prefetch" href="/assets/js/21.5b25527b.js"><link rel="prefetch" href="/assets/js/22.a717549c.js"><link rel="prefetch" href="/assets/js/23.b37c3dac.js"><link rel="prefetch" href="/assets/js/24.b59423b7.js"><link rel="prefetch" href="/assets/js/25.5e852821.js"><link rel="prefetch" href="/assets/js/26.d74df0db.js"><link rel="prefetch" href="/assets/js/27.482fea2c.js"><link rel="prefetch" href="/assets/js/28.9410d2dc.js"><link rel="prefetch" href="/assets/js/29.26c2a1a1.js"><link rel="prefetch" href="/assets/js/3.de569e7b.js"><link rel="prefetch" href="/assets/js/30.bda763c6.js"><link rel="prefetch" href="/assets/js/32.09468acb.js"><link rel="prefetch" href="/assets/js/33.6bff03c3.js"><link rel="prefetch" href="/assets/js/34.edff19f2.js"><link rel="prefetch" href="/assets/js/35.f3fda163.js"><link rel="prefetch" href="/assets/js/36.288dcf73.js"><link rel="prefetch" href="/assets/js/37.1ac06ffd.js"><link rel="prefetch" href="/assets/js/38.ae76a2f2.js"><link rel="prefetch" href="/assets/js/39.d98d9b39.js"><link rel="prefetch" href="/assets/js/4.c4a61988.js"><link rel="prefetch" href="/assets/js/40.f8126f11.js"><link rel="prefetch" href="/assets/js/41.756b01e9.js"><link rel="prefetch" href="/assets/js/42.a45fb273.js"><link rel="prefetch" href="/assets/js/43.0f06de4d.js"><link rel="prefetch" href="/assets/js/44.2cb104af.js"><link rel="prefetch" href="/assets/js/45.295815fd.js"><link rel="prefetch" href="/assets/js/46.4a958c55.js"><link rel="prefetch" href="/assets/js/47.cc61a05b.js"><link rel="prefetch" href="/assets/js/48.58021ccc.js"><link rel="prefetch" href="/assets/js/49.495e04eb.js"><link rel="prefetch" href="/assets/js/5.bafa66ed.js"><link rel="prefetch" href="/assets/js/50.0ba72f8e.js"><link rel="prefetch" href="/assets/js/51.f01ff3d0.js"><link rel="prefetch" href="/assets/js/52.24b95130.js"><link rel="prefetch" href="/assets/js/53.c2f99ba6.js"><link rel="prefetch" href="/assets/js/54.d8c53428.js"><link rel="prefetch" href="/assets/js/55.f288b8ba.js"><link rel="prefetch" href="/assets/js/56.fe0c77f6.js"><link rel="prefetch" href="/assets/js/57.a41bae1d.js"><link rel="prefetch" href="/assets/js/58.ca6fe63c.js"><link rel="prefetch" href="/assets/js/59.265386a9.js"><link rel="prefetch" href="/assets/js/6.130b86a1.js"><link rel="prefetch" href="/assets/js/60.67e4b1a0.js"><link rel="prefetch" href="/assets/js/61.43b876fa.js"><link rel="prefetch" href="/assets/js/62.f9a6351a.js"><link rel="prefetch" href="/assets/js/63.085930e7.js"><link rel="prefetch" href="/assets/js/64.019d06db.js"><link rel="prefetch" href="/assets/js/65.192f99be.js"><link rel="prefetch" href="/assets/js/66.6f0b195f.js"><link rel="prefetch" href="/assets/js/67.cd9f2f08.js"><link rel="prefetch" href="/assets/js/68.6834d557.js"><link rel="prefetch" href="/assets/js/69.ef5cf8c4.js"><link rel="prefetch" href="/assets/js/70.7f33b94e.js"><link rel="prefetch" href="/assets/js/71.4f6f8ac5.js"><link rel="prefetch" href="/assets/js/72.46080b15.js"><link rel="prefetch" href="/assets/js/73.1da5fdd4.js"><link rel="prefetch" href="/assets/js/74.fb18f390.js"><link rel="prefetch" href="/assets/js/75.42184a99.js"><link rel="prefetch" href="/assets/js/76.4e138b3c.js"><link rel="prefetch" href="/assets/js/77.d82bd0d7.js"><link rel="prefetch" href="/assets/js/78.46fe81a9.js"><link rel="prefetch" href="/assets/js/79.d8d6ae10.js"><link rel="prefetch" href="/assets/js/8.d2718ab9.js"><link rel="prefetch" href="/assets/js/80.76c8bdc2.js"><link rel="prefetch" href="/assets/js/81.e93fd370.js"><link rel="prefetch" href="/assets/js/82.8f04ec41.js"><link rel="prefetch" href="/assets/js/83.2269fe3e.js"><link rel="prefetch" href="/assets/js/84.154c626f.js"><link rel="prefetch" href="/assets/js/9.378d1dd2.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.e07e82db.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9d8bef43.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>FeliksLv的博客</h3> <p class="description" data-v-59e6cb88>记录学习过程，分享生活琐碎。</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>FeliksLv</span>
          
        <span data-v-59e6cb88>2019 - </span>
        2024
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="FeliksLv的博客" class="logo"> <span class="site-name">FeliksLv的博客</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/后端/" class="nav-link"><i class="undefined"></i>
  后端
</a></li><li class="dropdown-item"><!----> <a href="/categories/公共基础/" class="nav-link"><i class="undefined"></i>
  公共基础
</a></li><li class="dropdown-item"><!----> <a href="/categories/客户端/" class="nav-link"><i class="undefined"></i>
  客户端
</a></li><li class="dropdown-item"><!----> <a href="/categories/前端/" class="nav-link"><i class="undefined"></i>
  前端
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div><div class="nav-item"><a href="/others/about.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    FeliksLv
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>34</h3> <h6 data-v-1fad0c41>文章</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>19</h3> <h6 data-v-1fad0c41>标签</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/后端/" class="nav-link"><i class="undefined"></i>
  后端
</a></li><li class="dropdown-item"><!----> <a href="/categories/公共基础/" class="nav-link"><i class="undefined"></i>
  公共基础
</a></li><li class="dropdown-item"><!----> <a href="/categories/客户端/" class="nav-link"><i class="undefined"></i>
  客户端
</a></li><li class="dropdown-item"><!----> <a href="/categories/前端/" class="nav-link"><i class="undefined"></i>
  前端
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div><div class="nav-item"><a href="/others/about.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于
</a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>Web 开发的安全之旅</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>FeliksLv</span>
          
        <span data-v-59e6cb88>2019 - </span>
        2024
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">Web 开发的安全之旅</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>FeliksLv</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2021/8/22</span></i> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>Web</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="cross-site-scripting-xss"><a href="#cross-site-scripting-xss" class="header-anchor">#</a> Cross-Site Scripting(XSS)</h2> <p>跨站脚本攻击，指攻击者将恶意脚本插入到页面中进行执行。</p> <p>原因：</p> <ul><li>开发者盲目信任用户提交的内容</li> <li>直接使用字符串生成 dom</li></ul> <p>特点：</p> <ul><li>通常难以从 UI 上感知（暗地执行脚本）</li> <li>窃取用户信息（cookie/token）</li> <li>绘制 UI（例如弹窗），诱骗用户点击/填写表单</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> content<span class="token punctuation">,</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
  <span class="token comment">// 没有对centent进行校验</span>
  <span class="token keyword">await</span> db<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    content<span class="token punctuation">,</span>
    id
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> content <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 没有对 centent 过滤</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>content<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>攻击者可以提交以下代码，来实现XSS攻击</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/submit'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> Json<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;script&gt;alert(&quot;xss&quot;);&lt;/script&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="stored-xss"><a href="#stored-xss" class="header-anchor">#</a> Stored XSS</h3> <ul><li>恶意脚本被存在数据库中</li> <li>访问页面 -&gt; 读数据 === 被攻击</li> <li>危害最大，对全部用户可见</li></ul> <p>举个例子：假如爱奇艺受到了 xss 攻击，你的用户名和密码就有可能被窃取，从此电商网站上就多了一个共享账户。</p> <h3 id="reflected-xss"><a href="#reflected-xss" class="header-anchor">#</a> Reflected XSS</h3> <ul><li>不涉及数据库</li> <li>从 URL 上攻击，注入在服务端完成</li></ul> <p>举个例子：</p> <p>有这样一个 URL <code>host/path/?param=&lt;script&gt;alert('123')&lt;/script&gt;</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> param <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>param<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="dom-based-xss"><a href="#dom-based-xss" class="header-anchor">#</a> DOM-based XSS</h3> <ul><li>不需要服务器的参与</li> <li>发起和执行，全在浏览器完成</li></ul> <p>URL <code>host/path/?param=&lt;script&gt;alert('123')&lt;/script&gt;</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> content <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">.</span>searchParams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'params'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 😈😈 恶意脚本注入</span>
div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> content<span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="mutation-based-xss"><a href="#mutation-based-xss" class="header-anchor">#</a> Mutation-based XSS</h3> <ul><li>利用了浏览器渲染 DOM 的特性（独特优化）</li> <li>不同浏览器，会有区别（按浏览器进行攻击）</li></ul> <p>下面代码会被部分浏览器优化
<code>&lt;noscript&gt;&lt;p title=&quot;&lt;/noscript&gt;&lt;img src=x onerror=alert(1)&quot;&gt;</code></p> <p>从而变成</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>noscript</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>
&lt;/noscript&gt;
&lt;image src=<span class="token punctuation">&quot;</span></span><span class="token attr-name">x&quot;</span> <span class="token special-attr"><span class="token attr-name">onerror</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
  &quot;&quot;&gt;&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="防御xss"><a href="#防御xss" class="header-anchor">#</a> 防御XSS</h3> <ul><li>永远不要相信用户的提交信息</li> <li>不要将用户提交的内容直接转换成DOM</li></ul> <p>前端：</p> <ul><li>主流框架默认防御XSS</li> <li>google-closure-library</li></ul> <p>服务端（Node）</p> <ul><li>DOMPurify</li></ul> <p>仍要注意一下部分：</p> <ul><li>string -&gt; DOM</li> <li>上传SVG</li> <li>自定义跳转链接</li> <li>自定义样式（例如：background: url(xxx)）</li></ul> <h2 id="cross-site-request-forgery-csrf"><a href="#cross-site-request-forgery-csrf" class="header-anchor">#</a> Cross-site request forgery(CSRF)</h2> <p>跨站伪造请求</p> <ul><li>在用户不知情的前提下</li> <li>利用用户的权限（cookie）</li> <li>构造指定 HTTP 请求，窃取或修改用户敏感信息</li></ul> <p>主动请求</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://bank.com/transfer?to=hacker&amp;amount=100<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>点我抽奖<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>被动请求</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> display:none;<span class="token punctuation">&quot;</span></span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://bank.com/transfer?to=hacker&amp;amount=100<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="same-origin-policy"><a href="#same-origin-policy" class="header-anchor">#</a> Same-origin Policy</h3> <p>HTTP请求：同源👌</p> <ul><li>协议</li> <li>域名</li> <li>端口</li></ul> <h3 id="content-security-policy-csp"><a href="#content-security-policy-csp" class="header-anchor">#</a> Content Security Policy(CSP)</h3> <ul><li>哪些源(域名)被认为是安全的</li> <li>来自安全源的脚本可以执行，否则直接抛错</li> <li>对eval + inline script说 🚫</li></ul> <p>通过配置服务器请求头部</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>Content-Security<span class="token operator">=</span>Policy: script-src <span class="token string">'self'</span> <span class="token comment">#同源</span>
Content-Security<span class="token operator">=</span>Policy: script-src <span class="token string">'self'</span> https://domain.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>浏览器meta</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Content-Security-Policy<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>script-src self<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="csrf的防御"><a href="#csrf的防御" class="header-anchor">#</a> CSRF的防御</h3> <p>推荐在中间件中，对csrf进行统一处理，例如Spring Security，可以定义请求的fliter。</p> <ul><li>限制请求的Origin和Referer（同源请求中，GET+HEAD不发送Origin需要特别处理）</li> <li>使用token，token和用户绑定，要有过期时间</li> <li>GET !== GET + POST 写接口不要偷懒</li></ul> <h4 id="iframe攻击"><a href="#iframe攻击" class="header-anchor">#</a> iframe攻击</h4> <p><img src="/assets/img/iframe.19653b88.png" alt="iframe攻击"></p> <h4 id="samesite-cookie"><a href="#samesite-cookie" class="header-anchor">#</a> SameSite Cookie</h4> <p><img src="/assets/img/samesite-cookie.96f62e99.png" alt="SameSite Cookie"></p> <h2 id="injection"><a href="#injection" class="header-anchor">#</a> Injection</h2> <h3 id="sql-injection"><a href="#sql-injection" class="header-anchor">#</a> SQL Injection</h3> <p>请求携带sql参数（恶意注入）-&gt; server拼接参数，运行sql code -&gt; 获取数据、删除数据、修改数据</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 读取请求字段，以字符串拼接SQL</span>
<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">renderForm</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> username<span class="token punctuation">,</span> form_id <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> sql<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    SELECT a, b, c FROM table
    WHERE username = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>username<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
    AND form_id = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>form_id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token function">renderForm</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>攻击者如果提交以下代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;/api&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;applicaiton/json&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&quot;any; DROP TABLE table;&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>这就会变成下面的sql语句</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> XXX <span class="token keyword">FROM</span> XXX<span class="token punctuation">;</span> <span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">table</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>🎉：被动删库跑路成就达成 ✅</p> <h3 id="injection-不至于-sql"><a href="#injection-不至于-sql" class="header-anchor">#</a> Injection 不至于 SQL</h3> <ul><li>CLI</li> <li>OS command</li> <li>Server-Side Request Forgery(SSRF)，服务端伪造请求（严格来说SSRF不是注入，但是原理类似）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">convertVideo</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> video<span class="token punctuation">,</span> options <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
  <span class="token function">exec</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">convert-cli </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>video<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> -o </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>options<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">&quot;ok&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>那这就很危险了，比如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;/api&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&amp;&amp; rm -rf xxx</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>还有例如服务器暴露了一些重要文件，比如nginx的配置文件，那么攻击者就可以将请求修改成前往第三方服务器</p> <h4 id="ssrf-demo"><a href="#ssrf-demo" class="header-anchor">#</a> SSRF demo</h4> <p>请求用户自定义的callback url，从而导致内网内容的泄露</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">webHook</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//callback 可能是内网url</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>query<span class="token punctuation">.</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="防御injection"><a href="#防御injection" class="header-anchor">#</a> 防御Injection</h3> <h4 id="sql"><a href="#sql" class="header-anchor">#</a> SQL</h4> <ul><li>找到项目中查询 SQL 的地方</li> <li>使用 prepared statement</li></ul> <h4 id="beyond-sql"><a href="#beyond-sql" class="header-anchor">#</a> beyond SQL</h4> <ul><li>最小权限原则：禁止 sudo || root</li> <li>建立允许名单 + 过滤 ： rm</li> <li>对 URL 类型参数进行协议、域名、ip等限制：禁止访问内网</li></ul> <h2 id="denial-of-service-dos"><a href="#denial-of-service-dos" class="header-anchor">#</a> Denial of Service(DoS)</h2> <blockquote><p>服务拒绝：通过某种方式（构造特定请求），导致服务器资源被显著消耗，来不及响应更多请求，导致请求挤压，进而雪崩效应。</p></blockquote> <h3 id="redos-基于正则表达式的-dos"><a href="#redos-基于正则表达式的-dos" class="header-anchor">#</a> ReDoS: 基于正则表达式的 DoS</h3> <p>正则表达式： <code>/^((ab)*)+$/</code>
字符串：<code>abababababababa</code></p> <p>末尾的a会导致不断进行匹配，从而使得响应时间增加，接口吞吐量减少。</p> <h3 id="distributed-dos-ddos"><a href="#distributed-dos-ddos" class="header-anchor">#</a> Distributed DoS(DDoS)</h3> <p>短时间内，来自大量僵尸设备的请求流量，服务器不能及时完成全部请求，导致请求堆积，进而雪崩效应，无法响应新请求。</p> <p><strong>「不搞复杂的，量大就完事儿了」</strong></p> <p>攻击特点</p> <ul><li>直接访问 IP</li> <li>任意 API</li> <li>消耗大量带宽（耗尽）</li></ul> <h4 id="syn-flood"><a href="#syn-flood" class="header-anchor">#</a> SYN Flood</h4> <p><img src="/assets/img/syn-flood.153423d4.png" alt="SYN Flood"></p> <h3 id="防御ddos"><a href="#防御ddos" class="header-anchor">#</a> 防御DDoS</h3> <ul><li>流量治理
<ul><li>负载均衡</li> <li>API网关</li> <li>CDN</li></ul></li> <li>快速自动扩容</li> <li>非核心服务降级</li></ul> <h2 id="传输层攻击"><a href="#传输层攻击" class="header-anchor">#</a> 传输层攻击</h2> <h3 id="中间人攻击"><a href="#中间人攻击" class="header-anchor">#</a> 中间人攻击</h3> <p><img src="/assets/img/middle.b7c0bc25.png" alt="中间人攻击">
原因：</p> <ul><li>明文传输</li> <li>信息篡改不可知</li> <li>对方身份未验证</li></ul> <h3 id="防御中间人"><a href="#防御中间人" class="header-anchor">#</a> 防御中间人</h3> <p>HTTPS</p> <ul><li>可靠性：加密</li> <li>完整性：MAC验证</li> <li>不可抵赖性：数字签名</li></ul> <h4 id="tls-1-2"><a href="#tls-1-2" class="header-anchor">#</a> TLS 1.2</h4> <p><img src="/assets/img/tls.96dd4e79.png" alt="TLS 1.2"></p> <h4 id="https完整性"><a href="#https完整性" class="header-anchor">#</a> HTTPS完整性</h4> <p>传输内容：加密信息 + 加密信息_hash</p> <p>对hash值进行校验</p> <h4 id="数字签名"><a href="#数字签名" class="header-anchor">#</a> 数字签名</h4> <p>签名执行者有两样东西:</p> <ul><li>privateKey</li> <li>publicKey</li></ul> <p>私钥 + 内容 ---&gt; signature</p> <p>publicKey: 判断 signature是否是使用privateKey生成的</p> <p>浏览器验证证书和CA（Certificate Authority 证书机构）的publicKey。</p> <blockquote><p>当签名算法不够健壮的时候，又可能会被暴力破解。</p></blockquote> <h4 id="http-strict-transport-security-hsts"><a href="#http-strict-transport-security-hsts" class="header-anchor">#</a> HTTP Strict- -Transport- Security(HSTS)</h4> <p>HSTS 是 HTTP 严格传输安全（HTTP Strict Transport Security） 的缩写。 这是一种网站用来声明他们只能使用安全连接（HTTPS）访问的方法。 如果一个网站声明了 HSTS 策略，浏览器必须拒绝所有的 HTTP 连接并阻止用户接受不安全的 SSL 证书。 目前大多数主流浏览器都支持 HSTS (只有一些移动浏览器无法使用它)。</p> <h4 id="subresource-integrity-sri"><a href="#subresource-integrity-sri" class="header-anchor">#</a> Subresource Integrity(SRI)</h4> <p>静态资源一般放到CDN，如果CDN被劫持，我们可以对比hash。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://example.com/app.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">integrity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sha384-{some-hash-value}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">crossorigin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>anonymous<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>验证伪代码</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> remoteHash <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>tagHash <span class="token operator">!=</span> remoteHash<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;wrong hash&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="feature-policy-permission-policy"><a href="#feature-policy-permission-policy" class="header-anchor">#</a> Feature Policy/Permission Policy</h4> <p>限制一个源（页面）下，可以使用哪些功能：</p> <ul><li>camera</li> <li>microphone</li> <li>autoplay</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">allow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xxx<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="阅读材料"><a href="#阅读材料" class="header-anchor">#</a> 阅读材料</h2> <ul><li><a href="https://aws.amazon.com/cn/shield/ddos-attack-protection/" target="_blank" rel="noopener noreferrer">DDoS攻击是什么_DDoS是什么_DDoS云防御-AWS云服务 (amazon.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/AngusFu/diary/issues/32" target="_blank" rel="noopener noreferrer">关于 Web 安全突然想到的 · Issue #32 · AngusFu/diary (github.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://imnerd.org/samesite.html" target="_blank" rel="noopener noreferrer">SameSite 那些事 | 怡红院落 (imnerd.org)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.amazon.com/Web-Application-Security-Exploitation-Countermeasures/dp/1492053112/ref=sr_1_3?crid=3KZBER4W7Z6JF&amp;dchild=1&amp;keywords=web+security&amp;qid=1627822659&amp;sprefix=web+secu%2Caps%2C360&amp;sr=8-3" target="_blank" rel="noopener noreferrer">Amazon.com: Web Application Security: Exploitation and Countermeasures for Modern Web Applications: 9781492053118: Hoffman, Andrew: Books<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2021/8/25 03:35:48</span></div></footer> <!----> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/blogs/basic/web-security.html#cross-site-scripting-xss" class="sidebar-link reco-side-cross-site-scripting-xss" data-v-b57cc07c>Cross-Site Scripting(XSS)</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#stored-xss" class="sidebar-link reco-side-stored-xss" data-v-b57cc07c>Stored XSS</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#reflected-xss" class="sidebar-link reco-side-reflected-xss" data-v-b57cc07c>Reflected XSS</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#dom-based-xss" class="sidebar-link reco-side-dom-based-xss" data-v-b57cc07c>DOM-based XSS</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#mutation-based-xss" class="sidebar-link reco-side-mutation-based-xss" data-v-b57cc07c>Mutation-based XSS</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#防御xss" class="sidebar-link reco-side-防御xss" data-v-b57cc07c>防御XSS</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/basic/web-security.html#cross-site-request-forgery-csrf" class="sidebar-link reco-side-cross-site-request-forgery-csrf" data-v-b57cc07c>Cross-site request forgery(CSRF)</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#same-origin-policy" class="sidebar-link reco-side-same-origin-policy" data-v-b57cc07c>Same-origin Policy</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#content-security-policy-csp" class="sidebar-link reco-side-content-security-policy-csp" data-v-b57cc07c>Content Security Policy(CSP)</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#csrf的防御" class="sidebar-link reco-side-csrf的防御" data-v-b57cc07c>CSRF的防御</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/basic/web-security.html#injection" class="sidebar-link reco-side-injection" data-v-b57cc07c>Injection</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#sql-injection" class="sidebar-link reco-side-sql-injection" data-v-b57cc07c>SQL Injection</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#injection-不至于-sql" class="sidebar-link reco-side-injection-不至于-sql" data-v-b57cc07c>Injection 不至于 SQL</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#防御injection" class="sidebar-link reco-side-防御injection" data-v-b57cc07c>防御Injection</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/basic/web-security.html#denial-of-service-dos" class="sidebar-link reco-side-denial-of-service-dos" data-v-b57cc07c>Denial of Service(DoS)</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#redos-基于正则表达式的-dos" class="sidebar-link reco-side-redos-基于正则表达式的-dos" data-v-b57cc07c>ReDoS: 基于正则表达式的 DoS</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#distributed-dos-ddos" class="sidebar-link reco-side-distributed-dos-ddos" data-v-b57cc07c>Distributed DoS(DDoS)</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#防御ddos" class="sidebar-link reco-side-防御ddos" data-v-b57cc07c>防御DDoS</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/basic/web-security.html#传输层攻击" class="sidebar-link reco-side-传输层攻击" data-v-b57cc07c>传输层攻击</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#中间人攻击" class="sidebar-link reco-side-中间人攻击" data-v-b57cc07c>中间人攻击</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/basic/web-security.html#防御中间人" class="sidebar-link reco-side-防御中间人" data-v-b57cc07c>防御中间人</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/basic/web-security.html#阅读材料" class="sidebar-link reco-side-阅读材料" data-v-b57cc07c>阅读材料</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.919d6661.js" defer></script><script src="/assets/js/7.5aa8e1b9.js" defer></script><script src="/assets/js/2.46317bd9.js" defer></script><script src="/assets/js/1.57079a2a.js" defer></script><script src="/assets/js/31.f98198e9.js" defer></script>
  </body>
</html>
